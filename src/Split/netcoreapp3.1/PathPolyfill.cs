// <auto-generated />
#pragma warning disable


namespace Polyfills;

using System;
using System.IO;

static partial class Polyfill
{
    extension(Path)
    {
#if FeatureMemory

        /// <summary>
        /// Combines a span of strings into a path.
        /// </summary>
        //Link: https://learn.microsoft.com/en-us/dotnet/api/system.io.path.combine?view=net-10.0#system-io-path-combine(system-readonlyspan((system-string)))
        public static string Combine(scoped ReadOnlySpan<string> paths) =>
            Path.Combine(paths.ToArray());


#endif

        static bool IsRoot(string path) =>
            Path.IsPathRooted(path) && Path.GetDirectoryName(path) == null;

        static bool IsDirectorySeparator(char c) =>
            c == Path.DirectorySeparatorChar ||
            c == Path.AltDirectorySeparatorChar;

        /// <summary>
        /// Determines whether the specified file or directory exists.
        /// </summary>
        //Link: https://learn.microsoft.com/en-us/dotnet/api/system.io.path.exists?view=net-10.0
        public static bool Exists(string? path)
        {
            if (string.IsNullOrEmpty(path))
            {
                return false;
            }

            string? fullPath;
            try
            {
                fullPath = Path.GetFullPath(path);
            }
            catch (Exception ex)
                when (ex is ArgumentException or
                          IOException or
                          UnauthorizedAccessException)
            {
                return false;
            }

            return File.Exists(fullPath) || Directory.Exists(fullPath);
        }
    }
}
